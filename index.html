<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROGRAMA DE DIGNIFICACIÓN DE EQUIPAMIENTO INSTITUCIONAL 2026</title>
    <!-- <style>
            <?!= include("styles"); ?> 
    </style>
    -->

      <link rel="stylesheet" href="styles.css"> 

</head>
<body>
    
<form id="miFormulario">
   <h2>PROGRAMA DE DIGNIFICACIÓN DE EQUIPAMIENTO INSTITUCIONAL 2026 (PDEI 2026)</h2>
  <fieldset>
    <legend>Información Básica Test 5.16</legend>
    
    <div class="form_input">
      <label for="secretaria">Secretaría</label>
      <input id="secretaria" name="secretaria" placeholder="   ">
    </div>

    <div class="form_input">
      <label for="direccion">Dirección</label>
      <input id="direccion" name="direccion" placeholder="direccion">
    </div>

    <div class="form_input">
      <label for="nivel">Nivel/Area/otro</label>
      <select name="nivel" id="nivel">
        <option value="Nivel Medio Superior">Nivel Medio Superior</option>
        <option value="Nivel Superior">Nivel Superior</option>
        <option value="administrativos">Administrativos</option>
        <option value="otros">Otros</option>
      </select>
    </div>
    <div class="form_input">
      <label for="dependencia">Dependencia</label>
      <input id="dependencia" name="dependencia" placeholder="CECyT 10">
    </div>
    
    <div class="form_input">
      <label for="ubicacion">Ubicación(Domicilio)</label>
      <input id="ubicacion" name="ubicacion" placeholder="Lugia_Djokovic@hotmail.com">
    </div>

    <div class="form_input">
      <label for="titular">Titular</label>
      <input id="titular" name="titular" placeholder="Titular ">
    </div>

    <div class="form_input">
      <label for="telefonoTitular">Teléfono Titular</label>
      <input id="telefonoTitular" name="telefonoTitular" placeholder="telefono del Titular ">
    </div>

    <div class="form_input">
      <label for="correoTitular">Correo Titular</label>
      <input id="correoTitular" name="correoTitular" placeholder="correo del Titular ">
    </div>
    
    <div class="form_input">
      <label for="responsable">Responsable de llenado(Capítulo 5000)</label>
      <input id="responsable" name="responsable" placeholder="responsable ">
    </div>


    <div class="form_input">
      <label for="telefonoResponsable">Teléfono Responsable</label>
      <input id="telefonoResponsable" name="telefonoResponsable" placeholder="telefono del Responsable ">
    </div>

    <div class="form_input">
      <label for="correoResponsable">Correo Responsable</label>
      <input id="correoResponsable" name="correoResponsable" placeholder="correo del Responsable ">
    </div>




  </fieldset>

  

  <button type="submit">Enviar</button>
   <p id="aviso"></p>
<table border="1" width="100%">
  <thead>
                               <tr>
                                    <th>
                                         Nivel  
                                    </th>
                
                                    <th>
                                         Dependencia
                                    </th>   

                                    <th>
                                         Nombre del Equipo
                                    </th>
                                    <th>
                                        Cantidad
                                    </th>
                                    <th>
                                        Marca/Modelo
                                    </th>

                                    <th>
                                        Clave CUCOP
                                    </th>

                                    <th>
                                        Justificación (Equipo no Existente, Sustitución o Complemento)
                                    </th>

                                    <th>
                                         Precio de referencia
                                    </th>
                     
                                    <th>
                                        Prioridad (Baja, Media, Alta, Urgente)
                                    </th>

                               </tr>
                        </thead>

                        <tbody id="tablaBody">
                                


                              
                        </tbody>     
</table>



    
</form>

</body>


<script>
 const tbody = document.getElementById("tablaBody");

for (let i = 1; i <= 15; i++) {
  const tr = document.createElement("tr");

  tr.innerHTML = `
    <td id="nivelR${i}" name="nivelR${i}" class="input_tabla"></td>

    <td id="dependenciaR${i}" name="dependenciaR${i}" class="input_tabla"></td>

    <td>
      <input name="nombredelEquipoR${i}" class="input_tabla">
    </td>

    <td>
      <input name="cantidadR${i}" class="input_tabla">
    </td>

    <td>
      <input name="marcaR${i}" class="input_tabla">
    </td>

    <td>
      <input name="claveCUCOPR${i}" class="input_tabla">
    </td>

    <td>
      <textarea
        name="justificacionR${i}"
        class="auto-expand input_tabla"
        rows="1"
        style="resize:none;"
      >Justificacion</textarea>
    </td>

    <td>
      <input name="precioR${i}" class="input_tabla">
    </td>

    <td>
      <input name="prioridadR${i}" class="input_tabla">
    </td>
  `;

  tbody.appendChild(tr);
}

const nivelInput = document.getElementById("nivel");
const dependenciaInput = document.getElementById("dependencia");
// Escuchamos cambios en nombre o apellido
nivelInput.addEventListener("input", generarNivel);
dependenciaInput.addEventListener("input", generarDependencia);


function generarNivel() {
  const valor = nivelInput.value.trim();
  // Selecciona todas las celdas cuyo id empieza con 'nivelR'
  const celdasNivel = document.querySelectorAll("[id^='nivelR']");
  celdasNivel.forEach(celda => celda.textContent = valor);
}

function generarDependencia() {
  const valor = dependenciaInput.value.trim();
  const celdasDep = document.querySelectorAll("[id^='dependenciaR']");
  celdasDep.forEach(celda => celda.textContent = valor);
}

const textareas = document.querySelectorAll(".auto-expand");

function autoResize(textarea) {
  textarea.style.height = "auto";
  textarea.style.height = textarea.scrollHeight + "px";
}

textareas.forEach(textarea => {
  textarea.addEventListener("input", () => autoResize(textarea));

  // Ajusta la altura inicial si ya tiene texto
  autoResize(textarea);
});

    

    
    
 const form = document.getElementById("miFormulario");
 const aviso = document.getElementById("aviso");   
    document.getElementById("miFormulario").addEventListener("submit", function(e){
                e.preventDefault();
                aviso.textContent = " ";
                const data = Object.fromEntries(new FormData(this));
                /*fetch("https://script.google.com/macros/s/AKfycbylJPoK0gXZxnMQzAWlCLGbwMvi7OsMV-rKF3eEpNDSkpbzZ8R6kzFAadKFIonA97Of-Q/exec", {
                                 method: "POST",
                                 body: new FormData(this)
                })*/
                
                 fetch("https://script.google.com/macros/s/AKfycbylJPoK0gXZxnMQzAWlCLGbwMvi7OsMV-rKF3eEpNDSkpbzZ8R6kzFAadKFIonA97Of-Q/exec", {
                  method: "POST",
                  body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(res => {
                 if (!res.success) {
                   aviso.textContent = "⚠️ " + res.message;
                   aviso.style.color = "red";
                   return;
                 }
                 aviso.textContent = "✅ Tu respuesta fue enviada correctamente";
                 aviso.style.color = "green";
                 form.reset();
                 alert("Datos enviados correctamente");
                 this.reset();
  })
  .catch(() => alert("Error al enviar"));
});


</script>




</html>























